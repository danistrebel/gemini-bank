{% extends "base.html" %}
{% block content%}
<a href="{{url_for('account', id=account.id)}}" class="btn btn-outline-secondary mb-4">Back to Account</a>
<h1>New Transaction</h1>
<form method="POST">
  {{ form.hidden_tag() }}
  <div class="mb-3">
    {{ form.description.label(class="form-label") }}
    {{ form.description(class="form-control") }}
  </div>
  <div class="mb-3">
    {{ form.amount.label(class="form-label") }}
    {{ form.amount(class="form-control") }}
  </div>
  <div class="mb-3">
    {{ form.type.label(class="form-label") }}
    {{ form.type(class="form-control") }}
    {% if user != "anonymous" and user.accounts.count() <= 1 %}
    <div id="transfer-warning" class="alert alert-warning mt-2" style="display:none;">
      Transfer is not possible since you have no other account to transfer to.
    </div>
    {% endif %}
  </div>
  {{ form.submit(class="btn btn-primary") }}
</form>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    var typeSelect = document.getElementById('type');
    var warningAlert = document.getElementById('transfer-warning');

    if (typeSelect && warningAlert) {
      function checkType() {
        if (typeSelect.value === 'transfer') {
          warningAlert.style.display = 'block';
        } else {
          warningAlert.style.display = 'none';
        }
      }

      typeSelect.addEventListener('change', checkType);
      // Run on initial load in case "transfer" was already selected (e.g. by browser history)
      checkType();
    }
  });
</script>
{% endblock %}